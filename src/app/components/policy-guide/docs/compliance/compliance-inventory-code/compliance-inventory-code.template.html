<h1>Populating your code inventory</h1>
<h2>Overview</h2>
<p><a href="http://Code.gov">Code.gov</a> will provide a platform to find custom-developed source code intended both for Government-wide reuse and release as open source. <a href="http://Code.gov">Code.gov</a> will compile an aggregate source code inventory from each of the covered federal agencies respective code inventories. In order to balance the need for flexibility to cover range of government code repositories against the  consistency necessary for searching and discovery, we’ve prepared a metadata schema to help catalog each agency’s inventory. And as with all open source projects, the schema itself is a work in progres. As of this writing, we’re released version 1.0 of the metadata schema.</p>
<p>Agencies should make the “code.json” available in the root folder of their website (e.g., <a href="https://www.gsa.gov/code.json">https://www.gsa.gov/code.json</a>), and <a href="http://code.gov">Code.gov</a> will retrieve these JSON files daily (this is a similar approach to Project Open Data - <a href="http://Data.gov">Data.gov</a>).</p>
<h2>Schema Specification</h2>
<p>Each covered agency should prepare an inventory of its custom-developed source code as described in Section 05: <a href="https://github.com/presidential-innovation-fellows/code-gov-web/blob/master/_draft_content/02_compliance/05-metadata-schema-definition.md">https://github.com/presidential-innovation-fellows/code-gov-web/blob/master/_draft_content/02_compliance/05-metadata-schema-definition.md</a></p>
<h2>How to build your agency’s code inventory</h2>
<h3>Step 1. Reach out to bureaus and offices</h3>
<p>Federal agencies should include in their inventories custom code built or procured by subsidiary bureaus and offices.  The process of engaging bureaus and offices should help identify (1) what custom code is being developed, (2) who’s developing, (3) where the code repositories are being hosted, and (4) what development environments are being used. Not only will this information be helpful in building the agency’s inventories, but may also highlight areas for efficiency improvements and cost savings.</p>
<p>Do any of your bureaus have innovative or promising approaches to managing their code? Do they have an opportunity to connect and share best practices regarding custom-code development or procurement? When reaching out to subsidiary bureaus and offices take the opportunity to highlight success stories and build communities of practices across your agencies.</p>
<h3>Step 2. Find the source code</h3>
<p>After reaching out to offices that procure or develop custom-code, you may have a better sense of the bounds of your source-code universe. Identify which, if any, source code hosting services your offices use (e.g., Bitbucket, GitHub, Gitlab). For each service or hosting option, you’ll want to list (1) what code sets are located there, (2) the project name,  (3) what licenses exist for the source code, (4) access, and (5) the project owner organization. See below for example:</p>
<table class="table table-striped table-bordered">
<thead>
<tr>
<th>Source Code Hosting Service</th>
<th>Project Name</th>
<th>Access</th>
<th>License</th>
<th>Organization</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bitbucket</td>
<td>GovProject</td>
<td>Open Source</td>
<td>License</td>
<td></td>
</tr>
<tr>
<td>Gitlab</td>
<td>GovProject#2</td>
<td>Government Reuse</td>
<td>Unknown</td>
<td>Office of Technology</td>
</tr>
<tr>
<td>Internal</td>
<td>TeamBuilding Thing</td>
<td>Open Source</td>
<td>CC0 (Waiver)</td>
<td>Office of Technology</td>
</tr>
<tr>
<td>Internal</td>
<td>TopSecret Project</td>
<td>Closed</td>
<td>Unknown</td>
<td>Office of Technology</td>
</tr>
</tbody>
</table>
<h3>Step 3. Compile a draft</h3>
<p>From the table or list you’ve provided in the previous step, you will be able to create a rough draft of your agency’s inventory. The more complete this table is, the easier it will be to compile the inventory. Regardless of whether the project is open source or closed subject to an exemption, each project should not only have an organizational owner but also a license which describes the terms of its use. For more information about licensing, please review our advice on licensing here: (insert link).</p>
<h3><a id="Step_4_Prepare_for_public_consumption_29"></a>Step 4. Prepare for public consumption</h3>
<p>When preparing your agency’s code inventory, make sure that you have included all the required fields as define by the latest version of the metadata schema(insert link). The <a href="http://code.gov">Code.gov</a> discovery platform will validate each agency’s inventory against the format of the metadata schema and invalid inventories will not be accepted. If your agency plans to close a repository to government reuse (and, by extension, open source discovery) the agency must provide a justification for relying on one of the five exceptions stated in the source code policy. Each exception must be approved and documented by the agency’s CIO in prior to public release of the agency’s code inventory.</p>
<h4>Redactions - Government Reuse</h4>
<p>For code repositories limited to government reuse is permitted (not open source), agencies should redact the ‘repository’ field before compiling the inventory. Redaction can be as simple as removing the URL path to the project and replacing with the words ‘[REDACTED - FOR GOVERNMENT REUSE ONLY]’.</p>
<h4>Redactions - Closed</h4>
<p>Code repositories that are closed (i.e., not available as open source or government reuse) <em>should still be included in an agency’s inventory</em>. For example, agencies should redact the ‘repository’ field, any project tags identifying the project or the source code, before compiling the inventory. Redaction can be as simple as removing the URL path to the project and replacing with the words ‘[REDACTED - PURSUANT TO EXEMPTION #].’ Agencies should redact fields necessary to comply with the exceptions set forth in the source code policy.</p>
<h3>Step 5. Build the schema</h3>
<p>Using the resources provided below to automate the creation of your repository where possible. Once complete please name the file ‘code.json’ and use a JSON validator (links included in the <a href="https://github.com/presidential-innovation-fellows/code-gov-tools">code-gov-tools repository</a>) to validate the inventory is compliant with the latest form of the latest <a href="http://code.gov">Code.gov</a> metadata schema. Once confirmed please upload ‘code.json’ into the root folder (e.g. <a href="https://gsa.gov/code.json">https://gsa.gov/code.json</a>) of your agency’s website. The <a href="http://code.gov">code.gov</a> discovery platform will scan the root directory daily for the latest version of the file.</p>
<h2>Frequently Asked Questions</h2>
<h3>How do I build my agency’s inventory if my code is stored on … [Github, Bitbucket, Gitlab, etc.] ?</h3>
<p>We will be preparing a list of tools and resources to accomodate mapping and conversion to the <a href="http://code.gov">Code.gov</a> metadata schema. We will prioritize the development of those tools based on use/ demand by government agencies.</p>
<p><em>For Github</em>:
Mapping tool: <a href="https://github.com/presidential-innovation-fellows/code-gov-tools">code-gov-tools repository</a>
Other resources:
<a external-link href="https://developer.github.com/v3/">https://developer.github.com/v3/</a></p>
<p><em>For Bitbucket</em>
Resources: <a external-link href="https://confluence.atlassian.com/bitbucket/use-the-bitbucket-cloud-rest-apis-222724129.html">https://confluence.atlassian.com/bitbucket/use-the-bitbucket-cloud-rest-apis-222724129.html</a></p>
<h3>What tools are available to help me build my agency’s inventory?</h3>
<p>You can find links to our suite of tools here at the <a href="https://github.com/presidential-innovation-fellows/code-gov-tools">code-gov-tools repository</a></p>
Mapping tool: (insert link)
<p>
Other resources: <a external-link href="https://confluence.atlassian.com/bitbucket/use-the-bitbucket-cloud-rest-apis-222724129.html">https://confluence.atlassian.com/bitbucket/use-the-bitbucket-cloud-rest-apis-222724129.html</a></p>
<h3>What tools are available to help me build my agency’s inventory?</h3>
<p>go here: [link to separate guidance on tools agencies can use to build inventory]</p>
